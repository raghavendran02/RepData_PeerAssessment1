---
title: "Untitled"
output: html_document
---
## Loading and preprocessing the data
```{r}
activity<- read.table("activity.csv", sep = ",", stringsAsFactors = FALSE , 
                      header =TRUE)

```

## Are there differences in activity patterns between weekdays and weekends?
1. Create a new factor variable in the dataset with two levels - weekday and weekend indicating whether a given date is a weekday or weekend day.

```{r  echo = TRUE}

check_daytype<-function(day){
if(weekdays(as.Date(day)) %in% c("Sunday","Saturday")){
   day<-"weekend"
}
else
 {
   
 day <-"weekday"
 }
  
}
daytype<-data.frame(sapply(activity$date,check_daytype))
 activity_new<-cbind(activity,daytype)
 
 colnames(activity_new) <- c("steps","date","interval","daytype")
```
2. Make a panel plot containing a time series plot of the 5 minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis).
```{r comparative_plots, fig.width=10, fig.height=4}
mean_daywise_activity_weekday<- aggregate(steps~interval, activity_new[activity_new$daytype == "weekday",], FUN = mean, na.action = na.omit)

mean_daywise_activity_weekend<- aggregate(steps~interval, activity_new[activity_new$daytype == "weekend",], FUN = mean, na.action = na.omit)

par(mfrow = c(1,2))
with(mean_daywise_activity_weekday,plot(interval, steps, type = "l",main = "Activity on weekdays", xlab = "5 minute interval", ylab = "Average number of steps", xlim = c(500,2500)))
with(mean_daywise_activity_weekend,plot(interval, steps, type = "l",  main = "Activity on weekends", xlab = "5 minute interval", ylab = "Average number of steps",xlim = c(500,2500)))

```